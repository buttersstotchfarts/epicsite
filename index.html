<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>i do declare</title>
<style>
    body {
        background-color: black;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
    }

    #fartButton {
        cursor: pointer;
        display: block;
        transform-origin: center center;
        user-select: none;
        will-change: transform;
    }
</style>
</head>
<body>
<img src="button.png" id="fartButton" alt="Fart Button" draggable="false">

<script>
const button = document.getElementById('fartButton');
const fartSrc = 'fart.mp3';
const jamesSrc = 'james.mp3';

let sx = 1, sy = 1, r = 0;
let dx = 0, dy = 0, dr = 0;

const spring = 0.02;
const damping = 0.92;

let fartSounds = [];
let locked = false;

button.addEventListener('dragstart', e => e.preventDefault());

function animate() {
    dx += (1 - sx) * spring;
    dy += (1 - sy) * spring;
    dr += (0 - r) * spring;

    sx += dx;
    sy += dy;
    r += dr;

    dx *= damping;
    dy *= damping;
    dr *= damping;

    button.style.transform = `scale(${sx},${sy}) rotate(${r}deg)`;

    requestAnimationFrame(animate);
}
animate();

button.addEventListener('click', (e) => {
    if (locked) return;

    if (Math.random() < 0.01) {
        locked = true;
        fartSounds.forEach(a => a.pause());
        fartSounds = [];
        button.src = 'james.png';
        const jamesAudio = new Audio(jamesSrc);
        jamesAudio.play();
        jamesAudio.addEventListener('ended', () => {
            button.src = 'button.png';
            locked = false;
        });
        return;
    }

    const audio = new Audio(fartSrc);
    audio.play();
    fartSounds.push(audio);
    audio.addEventListener('ended', () => {
        fartSounds = fartSounds.filter(a => a !== audio);
    });

    const rect = button.getBoundingClientRect();
    const cx = e.clientX - (rect.left + rect.width / 2);
    const cy = e.clientY - (rect.top + rect.height / 2);
    const maxOffset = Math.max(rect.width, rect.height) / 2;

    dx += (cx / maxOffset) * 0.3;
    dy += -(cy / maxOffset) * 0.3;
    dr += (cx / maxOffset) * 10;
});
</script>
</body>
</html>
